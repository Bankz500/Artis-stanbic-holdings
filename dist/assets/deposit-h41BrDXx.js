import"./modulepreload-polyfill-B5Qt9EMX.js";import{initializeApp as T}from"https://www.gstatic.com/firebasejs/9.1.3/firebase-app.js";import{getAuth as y,onAuthStateChanged as x,signOut as u}from"https://www.gstatic.com/firebasejs/9.1.3/firebase-auth.js";import{getFirestore as B,doc as E,getDoc as b,collection as D,query as A,where as L,getDocs as F}from"https://www.gstatic.com/firebasejs/9.1.3/firebase-firestore.js";const $={apiKey:"AIzaSyABYV12B7RM2ZCD2G1lFTLpgJwflJFwEXY",authDomain:"beal-offshore.firebaseapp.com",projectId:"beal-offshore",storageBucket:"beal-offshore.firebasestorage.app",messagingSenderId:"1091834410162",appId:"1:1091834410162:web:56285433b5751e681745ab",measurementId:"G-CT463F3T6J"},N=T($),c=y(N),l=B(N);let h;const M=2e5;function a(){clearTimeout(h),h=setTimeout(()=>{const e=y();u(e).then(()=>{window.location.href="login.html"}).catch(n=>{console.error("Error signing out:",n),window.location.href="login.html"})},M)}document.addEventListener("mousemove",a);document.addEventListener("keypress",a);document.addEventListener("click",a);document.addEventListener("scroll",a);document.addEventListener("touchstart",a);a();const p=document.getElementById("balance"),w=document.getElementById("name");document.getElementById("history-container");const s=document.getElementById("pending-container");x(c,async e=>{if(console.log("Current user:",e),e){const n=E(l,"users",e.uid),o=await b(n);if(o.exists()){console.log("User data:",o.data());const t=o.data(),v=t.wallet||0;p?p.textContent=`$${parseFloat(v).toFixed(2)}`:console.warn("Balance element not found in the DOM"),w&&(w.textContent=t.firstName?`, ${t.firstName}`:", User");const C=D(l,"pending"),I=A(C,L("userId","==",e.uid)),g=await F(I);if(s)if(s.innerHTML="",!g.empty)g.forEach(i=>{const f=i.data(),d=document.createElement("div");d.className="bg-white p-4 rounded-lg shadow-md text-center",d.innerHTML=`
                                    <h3 class="font-semibold text-gray-800">${f.description||"No description"}</h3>
                                    <p class="text-gray-600">$${f.amount||""}</p>
                                `,s.appendChild(d)});else{const i=document.createElement("div");i.className="bg-white p-4 rounded-lg shadow-md text-center",i.innerHTML='<h3 class="font-semibold text-gray-800">No pending transactions</h3>',s.appendChild(i)}}else console.log("No user document found in Firestore."),alert("No user data found.")}else console.log("No user signed in, redirecting to sign-in page."),window.location.href="login.html"});window.signOut=function(){u(c).then(()=>{alert("Signed out successfully!"),window.location.href="login.html"}).catch(e=>{alert("Error signing out: "+e.message)})};c.onAuthStateChanged(async e=>{if(console.log("Current user:",e),e)try{const n=E(l,"users",e.uid),o=await b(n);if(o.exists()){const t=o.data();console.log("Fetched user data:",t),document.getElementById("account-name").textContent=t.firstName&&t.lastName?`${t.firstName} ${t.lastName}`:"Not Available"}else console.error("No user document found!"),document.getElementById("account-name").textContent="Not Available"}catch(n){console.error("Error fetching user data:",n),document.getElementById("account-name").textContent="Error loading name"}else console.error("User not signed in"),document.getElementById("account-name").textContent="Not Available"});let m=0;function r(){m=0}window.onload=function(){setInterval(function(){m++,m>=10&&(u(c),alert("You have been logged out due to inactivity."))},6e4),window.onmousemove=r,window.onkeypress=r,window.onclick=r,window.onscroll=r};
