import"./modulepreload-polyfill-B5Qt9EMX.js";import{initializeApp as A}from"https://www.gstatic.com/firebasejs/9.1.3/firebase-app.js";import{getAuth as F,onAuthStateChanged as M,signOut as N}from"https://www.gstatic.com/firebasejs/9.1.3/firebase-auth.js";import{getFirestore as H,doc as x,getDoc as E,collection as p,query as f,where as y,getDocs as w}from"https://www.gstatic.com/firebasejs/9.1.3/firebase-firestore.js";const L={apiKey:"AIzaSyABYV12B7RM2ZCD2G1lFTLpgJwflJFwEXY",authDomain:"beal-offshore.firebaseapp.com",projectId:"beal-offshore",storageBucket:"beal-offshore.firebasestorage.app",messagingSenderId:"1091834410162",appId:"1:1091834410162:web:56285433b5751e681745ab",measurementId:"G-CT463F3T6J"},I=A(L),m=F(I),l=H(I),b=document.getElementById("balance"),C=document.getElementById("name"),r=document.getElementById("history-container"),c=document.getElementById("pending-container");M(m,async e=>{if(console.log("Current user:",e),e){console.log("User is logged in:",e.uid),console.log("Current user:",e);const s=x(l,"users",e.uid),o=await E(s);if(console.log("User document exists:",o.exists()),o.exists()){console.log("User data:",o.data());const n=o.data(),B=n.wallet||0;b?b.textContent=`$${parseFloat(B).toFixed(2)}`:console.warn("Balance element not found in the DOM"),C&&(C.textContent=n.firstName?`, ${n.firstName}`:", User");const D=p(l,"history"),v=f(D,y("userId","==",e.uid)),g=await w(v);if(r)if(r.innerHTML="",!g.empty)g.forEach(t=>{const i=t.data(),a=document.createElement("div");a.className="bg-white p-4 rounded-lg shadow-md text-center",a.innerHTML=`
                                    <h3 class="font-semibold text-gray-800">${i.description||"No description"}</h3>
                                    <p class="text-gray-600">$${i.amount||""}</p>
                                `,r.appendChild(a)});else{const t=document.createElement("div");t.className="bg-white p-4 rounded-lg shadow-md text-center",t.innerHTML='<h3 class="font-semibold text-gray-800">No history</h3>',r.appendChild(t)}const T=p(l,"pending"),$=f(T,y("userId","==",e.uid)),h=await w($);if(c)if(c.innerHTML="",!h.empty)h.forEach(t=>{const i=t.data(),a=document.createElement("div");a.className="bg-white p-4 rounded-lg shadow-md text-center",a.innerHTML=`
                                    <h3 class="font-semibold text-gray-800">${i.description||"No description"}</h3>
                                    <p class="text-gray-600">$${i.amount||""}</p>
                                `,c.appendChild(a)});else{const t=document.createElement("div");t.className="bg-white p-4 rounded-lg shadow-md text-center",t.innerHTML='<h3 class="font-semibold text-gray-800">No pending transactions</h3>',c.appendChild(t)}}else console.log("No user document found in Firestore."),alert("No user data found.")}else console.log("No user signed in, redirecting to sign-in page."),window.location.href="login.html"});window.signOut=function(){N(m).then(()=>{alert("Signed out successfully!"),window.location.href="login.html"}).catch(e=>{alert("Error signing out: "+e.message)})};m.onAuthStateChanged(async e=>{if(console.log("Current user:",e),e)try{const s=x(l,"users",e.uid),o=await E(s);if(o.exists()){const n=o.data();console.log("Fetched user data:",n),document.getElementById("account-name").textContent=n.firstName&&n.lastName?`${n.firstName} ${n.lastName}`:"Not Available"}else console.error("No user document found!"),document.getElementById("account-name").textContent="Not Available"}catch(s){console.error("Error fetching user data:",s),document.getElementById("account-name").textContent="Error loading name"}else console.error("User not signed in"),document.getElementById("account-name").textContent="Not Available"});let u=0;function d(){u=0}window.onload=function(){setInterval(function(){u++,u>=10&&(N(m),alert("You have been logged out due to inactivity."))},6e4),window.onmousemove=d,window.onkeypress=d,window.onclick=d,window.onscroll=d};
