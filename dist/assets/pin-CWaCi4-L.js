import"./modulepreload-polyfill-B5Qt9EMX.js";import{initializeApp as l}from"https://www.gstatic.com/firebasejs/9.1.3/firebase-app.js";import{getAuth as c,onAuthStateChanged as m,signOut as u,signInWithEmailAndPassword as g}from"https://www.gstatic.com/firebasejs/9.1.3/firebase-auth.js";import{getFirestore as f,doc as s,getDoc as p,setDoc as w}from"https://www.gstatic.com/firebasejs/9.1.3/firebase-firestore.js";const y={apiKey:"AIzaSyCJdMdkW5NZF83PLBLYZk3yBAFsUxqautY",authDomain:"atpib-82d72.firebaseapp.com",projectId:"atpib-82d72",storageBucket:"atpib-82d72.firebasestorage.app",messagingSenderId:"938927546204",appId:"1:938927546204:web:ea096f1dfe3b3754dd6b99",measurementId:"G-G3BRPK5B9T"},i=l(y),a=c(i),r=f(i);m(a,async t=>{if(t){const n=s(r,"users",t.uid),o=await p(n);if(o.exists()){const e=o.data();document.getElementById("firstName").value=e.firstName||"",document.getElementById("firstName").placeholder=e.firstName||"First Name",document.getElementById("profileUsername").textContent=e.firstName||"@syndicate",document.getElementById("Deposit-account").textContent=e.deposit||"0.00",document.getElementById("Profit-wallet").textContent=e.profit||"0.00",document.getElementById("wallet").textContent=e.wallet||"0.00",document.getElementById("welcome-message").textContent=`Welcome ${e.firstName}`,document.getElementById("displayEmail").textContent=t.email}else console.log("No user document found."),alert("No user data found.")}else console.log("No user signed in. Redirecting to sign-in page."),window.location.href="login.html"});window.signOut=function(){u(a).then(()=>{alert("Signed out successfully!"),window.location.href="login.html"}).catch(t=>{alert("Error signing out: "+t.message)})};const h=document.getElementById("changePinForm");h.addEventListener("submit",t=>{t.preventDefault();const n=document.getElementById("newPin").value;if(n.length!==5||isNaN(n)){alert("Please enter a valid 5-digit PIN.");return}document.getElementById("passwordModal").classList.remove("hidden")});passwordConfirmForm.addEventListener("submit",async t=>{t.preventDefault();const n=document.getElementById("email").value,o=document.getElementById("firebasePassword").value;try{await g(a,n,o);const e=a.currentUser;if(!e)throw new Error("Authentication failed, no user signed in.");const d=s(r,"users",e.uid);await w(d,{pin:newPin},{merge:!0}),successMessage.classList.remove("hidden"),passwordModal.classList.add("hidden")}catch(e){console.error("Error updating PIN:",e),alert("Failed to update PIN. Please check your email and password and try again.")}});
