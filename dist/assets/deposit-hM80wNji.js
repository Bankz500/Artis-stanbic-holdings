import"./modulepreload-polyfill-B5Qt9EMX.js";import{initializeApp as $}from"https://www.gstatic.com/firebasejs/9.1.3/firebase-app.js";import{getAuth as T,onAuthStateChanged as A,signOut as M}from"https://www.gstatic.com/firebasejs/9.1.3/firebase-auth.js";import{getFirestore as U,doc as x,getDoc as b,collection as h,query as p,where as f,getDocs as y}from"https://www.gstatic.com/firebasejs/9.1.3/firebase-firestore.js";const F={apiKey:"AIzaSyABYV12B7RM2ZCD2G1lFTLpgJwflJFwEXY",authDomain:"beal-offshore.firebaseapp.com",projectId:"beal-offshore",storageBucket:"beal-offshore.firebasestorage.app",messagingSenderId:"1091834410162",appId:"1:1091834410162:web:56285433b5751e681745ab",measurementId:"G-CT463F3T6J"},N=$(F),m=T(N),l=U(N),w=document.getElementById("balance"),C=document.getElementById("name"),c=document.getElementById("history-container"),d=document.getElementById("pending-container");A(m,async e=>{if(console.log("Current user:",e),e){console.log("User is logged in:",e.uid),console.log("Current user:",e);const a=x(l,"users",e.uid),o=await b(a);if(console.log("User document exists:",o.exists()),o.exists()){console.log("User data:",o.data());const n=o.data(),i=n.wallet||0;w?w.textContent=`$${parseFloat(i).toFixed(2)}`:console.warn("Balance element not found in the DOM"),C&&(C.textContent=n.firstName?`, ${n.firstName}`:", User");const E=h(l,"history"),I=p(E,f("userId","==",e.uid)),g=await y(I);if(c)if(c.innerHTML="",!g.empty)g.forEach(t=>{const r=t.data(),s=document.createElement("div");s.className="bg-white p-4 rounded-lg shadow-md text-center",s.innerHTML=`
                                    <h3 class="font-semibold text-gray-800">${r.description||"No description"}</h3>
                                    <p class="text-gray-600">$${r.amount||""}</p>
                                `,c.appendChild(s)});else{const t=document.createElement("div");t.className="bg-white p-4 rounded-lg shadow-md text-center",t.innerHTML='<h3 class="font-semibold text-gray-800">No history</h3>',c.appendChild(t)}const B=h(l,"pending"),D=p(B,f("userId","==",e.uid)),u=await y(D);if(d)if(d.innerHTML="",!u.empty)u.forEach(t=>{const r=t.data(),s=document.createElement("div");s.className="bg-white p-4 rounded-lg shadow-md text-center",s.innerHTML=`
                                    <h3 class="font-semibold text-gray-800">${r.description||"No description"}</h3>
                                    <p class="text-gray-600">$${r.amount||""}</p>
                                `,d.appendChild(s)});else{const t=document.createElement("div");t.className="bg-white p-4 rounded-lg shadow-md text-center",t.innerHTML='<h3 class="font-semibold text-gray-800">No pending transactions</h3>',d.appendChild(t)}}else console.log("No user document found in Firestore."),alert("No user data found.")}else console.log("No user signed in, redirecting to sign-in page."),window.location.href="login.html"});window.signOut=function(){M(m).then(()=>{alert("Signed out successfully!"),window.location.href="login.html"}).catch(e=>{alert("Error signing out: "+e.message)})};m.onAuthStateChanged(async e=>{if(console.log("Current user:",e),e)try{const a=x(l,"users",e.uid),o=await b(a);if(console.log("User document exists:",o.exists()),o.exists()){const n=o.data();console.log("User data:",n);const i=document.getElementById("account-name");i&&(i.textContent=n.firstName&&n.lastName?` ${n.firstName} ${n.lastName}`:"Welcome, User")}else console.error("No user document found!"),document.getElementById("account-name").textContent="Not Available"}catch(a){console.error("Error fetching user data:",a),document.getElementById("account-name").textContent="Error loading name"}else console.error("User not signed in"),document.getElementById("account-name").textContent="Not Available"});
