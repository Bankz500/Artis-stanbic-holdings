import"./modulepreload-polyfill-B5Qt9EMX.js";import{initializeApp as $}from"https://www.gstatic.com/firebasejs/9.1.3/firebase-app.js";import{getAuth as v,onAuthStateChanged as B,signOut as T}from"https://www.gstatic.com/firebasejs/9.1.3/firebase-auth.js";import{getFirestore as D,doc as A,getDoc as L,collection as u,query as p,where as h,getDocs as y}from"https://www.gstatic.com/firebasejs/9.1.3/firebase-firestore.js";const S={apiKey:"AIzaSyCJdMdkW5NZF83PLBLYZk3yBAFsUxqautY",authDomain:"atpib-82d72.firebaseapp.com",projectId:"atpib-82d72",storageBucket:"atpib-82d72.firebasestorage.app",messagingSenderId:"938927546204",appId:"1:938927546204:web:ea096f1dfe3b3754dd6b99",measurementId:"G-G3BRPK5B9T"},f=$(S),I=v(f),c=D(f);function w(){alert("You have been logged out due to inactivity."),window.location.href="/login.html"}function M(){localStorage.setItem("lastActivity",Date.now().toString())}function k(){const e=localStorage.getItem("lastActivity"),s=Date.now();e&&s-parseInt(e,10)>ABSENCE_LIMIT&&w()}function x(){clearTimeout(inactivityTimeout),inactivityTimeout=setTimeout(()=>{w()},INACTIVITY_LIMIT),M()}["mousemove","keydown","click","scroll","touchstart"].forEach(e=>{window.addEventListener(e,x)});k();x();B(I,async e=>{if(e){console.log("User is logged in:",e.uid);const s=A(c,"users",e.uid),r=await L(s);if(r.exists()){const n=r.data();document.getElementById("Deposit-account").textContent=`${n.deposit||"$0.00"}`,document.getElementById("history1").textContent=`${n.history1||"No history available"}`,document.getElementById("history2").textContent=`${n.history2||"No history available"}`,document.getElementById("history3").textContent=`${n.history3||""}`,document.getElementById("wallet").textContent=`${n.wallet||"$0.00"}`,document.getElementById("bonus-wallet").textContent=`${n.bonus||"$0.00"}`,document.getElementById("pending1").textContent=`${n.pending1||"No pending transactions"}`,document.getElementById("pending2").textContent=`${n.pending2||""}`,document.getElementById("pending3").textContent=`${n.pending3||""}`;const l=document.getElementById("welcome-name");n.firstName?l.textContent=`Welcome back, ${n.firstName}`:(l.textContent="Welcome User",console.log("User data does not contain a name field."));const C=u(c,"history"),b=p(C,h("userId","==",e.uid)),g=await y(b),a=document.getElementById("history-container");if(a.innerHTML="",!g.empty)g.forEach(t=>{const i=t.data(),o=document.createElement("div");o.className="bg-white p-4 rounded-lg shadow-md text-center h-16",o.innerHTML=`
                                <h3 class="font-semibold text-gray-800">${i.description||"No description"}</h3>
                                <p class="text-gray-600">ID: ${t.id}</p>
                                <p class="text-gray-600">$${i.amount||""}</p>
                            `,a.appendChild(o)});else{console.log("No transaction history found for this user.");const t=document.createElement("div");t.className="bg-white p-4 rounded-lg shadow-md text-center h-16",t.innerHTML=`
                            <h3 class="font-semibold text-gray-800">No history</h3>
                            <p class="text-gray-600">You have no transaction history.</p>
                        `,a.appendChild(t)}const E=u(c,"pending"),N=p(E,h("userId","==",e.uid)),m=await y(N),d=document.getElementById("pending-container");if(d.innerHTML="",!m.empty)m.forEach(t=>{const i=t.data(),o=document.createElement("div");o.className="bg-white p-4 rounded-lg shadow-md text-center h-16",o.innerHTML=`
                                <h3 class="font-semibold text-gray-800">${i.description||"No description"}</h3>
                                <p class="text-gray-600">ID: ${t.id}</p>
                                <p class="text-gray-600">$${i.amount||""}</p>
                            `,d.appendChild(o)});else{console.log("No pending transactions found for this user.");const t=document.createElement("div");t.className="bg-white p-4 rounded-lg shadow-md text-center h-16",t.innerHTML=`
                            <h3 class="font-semibold text-gray-800">No pending transactions</h3>
                            <p class="text-gray-600">You have no pending transactions.</p>
                        `,d.appendChild(t)}}else console.log("No user document found in Firestore."),alert("No user data found.")}else console.log("No user signed in, redirecting to sign-in page."),window.location.href="sign-in.html"});window.signOut=function(){T(I).then(()=>{alert("Signed out successfully!"),window.location.href="sign-in.html"}).catch(e=>{alert("Error signing out: "+e.message)})};
