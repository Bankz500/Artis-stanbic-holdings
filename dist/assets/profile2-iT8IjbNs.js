import"./modulepreload-polyfill-B5Qt9EMX.js";import{initializeApp as m}from"https://www.gstatic.com/firebasejs/9.1.3/firebase-app.js";import{getAuth as u,onAuthStateChanged as p,updateProfile as f}from"https://www.gstatic.com/firebasejs/9.1.3/firebase-auth.js";import{getFirestore as g,getDoc as h,doc as l,updateDoc as y}from"https://www.gstatic.com/firebasejs/9.1.3/firebase-firestore.js";const I={apiKey:"AIzaSyCJdMdkW5NZF83PLBLYZk3yBAFsUxqautY",authDomain:"atpib-82d72.firebaseapp.com",projectId:"atpib-82d72",storageBucket:"atpib-82d72.firebasestorage.app",messagingSenderId:"938927546204",appId:"1:938927546204:web:ea096f1dfe3b3754dd6b99",measurementId:"G-G3BRPK5B9T"},s=m(I),d=u(s),c=g(s);window.onload=function(){document.getElementById("profileInfoCard").classList.remove("hidden"),p(d,async e=>{if(e){const o=document.getElementById("email"),t=document.getElementById("firstName");o.placeholder=e.email,o.value=e.email;try{const r=await h(l(c,"users",e.uid));if(r.exists()){const a=r.data(),i=a.firstName&&a.lastName?`${a.firstName} ${a.lastName}`:a.firstName||"No name set";t.value=i,t.placeholder=i}else t.value=e.displayName||"No name set",t.placeholder=e.displayName||"No name set";const n=e.photoURL||"https://via.placeholder.com/150";document.getElementById("profileImage").src=n}catch(r){console.error("Error fetching user data:",r),t.value="Error loading name",t.placeholder="Error loading name"}}})};document.getElementById("imageUpload").addEventListener("change",async function(e){const o=e.target.files[0];if(o){const t=new FormData;t.append("file",o),t.append("upload_preset","ASHB_profile");try{const n=await(await fetch("https://api.cloudinary.com/v1_1/dmgcagkqa/image/upload",{method:"POST",body:t})).json();if(n.secure_url){document.getElementById("profileImage").src=n.secure_url;const a=d.currentUser;a&&(await y(l(c,"users",a.uid),{photoURL:n.secure_url}),await f(a,{photoURL:n.secure_url}),alert("Profile image updated successfully!"))}}catch(r){console.error("Error uploading image:",r),alert("Failed to upload image. Please try again.")}}});window.updateProfile=function(){const e=document.getElementById("saveChangesButton"),o=e.textContent;e.disabled=!0,e.textContent="Processing...",setTimeout(function(){const t=document.getElementById("firstName").value.trim();if(!t){alert("Please enter valid information for full name.");return}localStorage.setItem("fullName",t),alert("Profile updated successfully!"),e.disabled=!1,e.textContent=o},2e3)};
