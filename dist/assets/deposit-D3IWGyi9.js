import"./modulepreload-polyfill-B5Qt9EMX.js";import{initializeApp as I}from"https://www.gstatic.com/firebasejs/9.1.3/firebase-app.js";import{getAuth as D,onAuthStateChanged as $,signOut as L}from"https://www.gstatic.com/firebasejs/9.1.3/firebase-auth.js";import{getFirestore as M,doc as H,getDoc as T,collection as m,query as g,where as p,getDocs as h}from"https://www.gstatic.com/firebasejs/9.1.3/firebase-firestore.js";const F={apiKey:"AIzaSyCJdMdkW5NZF83PLBLYZk3yBAFsUxqautY",authDomain:"atpib-82d72.firebaseapp.com",projectId:"atpib-82d72",storageBucket:"atpib-82d72.firebasestorage.app",messagingSenderId:"938927546204",appId:"1:938927546204:web:ea096f1dfe3b3754dd6b99",measurementId:"G-G3BRPK5B9T"},y=I(F),w=D(y),d=M(y),u=document.getElementById("balance"),f=document.getElementById("welcome-name"),i=document.getElementById("history-container"),s=document.getElementById("pending-container");$(w,async t=>{if(t){console.log("User is logged in:",t.uid);const b=H(d,"users",t.uid),r=await T(b);if(r.exists()){const a=r.data(),x=a.wallet||0;u?u.textContent=`$${parseFloat(x).toFixed(2)}`:console.warn("Balance element not found in the DOM"),f&&(f.textContent=a.firstName?`Welcome back, ${a.firstName}`:"Welcome, User");const C=m(d,"history"),N=g(C,p("userId","==",t.uid)),c=await h(N);if(i)if(i.innerHTML="",!c.empty)c.forEach(e=>{const o=e.data(),n=document.createElement("div");n.className="bg-white p-4 rounded-lg shadow-md text-center",n.innerHTML=`
                                    <h3 class="font-semibold text-gray-800">${o.description||"No description"}</h3>
                                    <p class="text-gray-600">$${o.amount||""}</p>
                                `,i.appendChild(n)});else{const e=document.createElement("div");e.className="bg-white p-4 rounded-lg shadow-md text-center",e.innerHTML='<h3 class="font-semibold text-gray-800">No history</h3>',i.appendChild(e)}const E=m(d,"pending"),B=g(E,p("userId","==",t.uid)),l=await h(B);if(s)if(s.innerHTML="",!l.empty)l.forEach(e=>{const o=e.data(),n=document.createElement("div");n.className="bg-white p-4 rounded-lg shadow-md text-center",n.innerHTML=`
                                    <h3 class="font-semibold text-gray-800">${o.description||"No description"}</h3>
                                    <p class="text-gray-600">$${o.amount||""}</p>
                                `,s.appendChild(n)});else{const e=document.createElement("div");e.className="bg-white p-4 rounded-lg shadow-md text-center",e.innerHTML='<h3 class="font-semibold text-gray-800">No pending transactions</h3>',s.appendChild(e)}}else console.log("No user document found in Firestore."),alert("No user data found.")}else console.log("No user signed in, redirecting to sign-in page."),window.location.href="sign-in.html"});window.signOut=function(){L(w).then(()=>{alert("Signed out successfully!"),window.location.href="sign-in.html"}).catch(t=>{alert("Error signing out: "+t.message)})};
