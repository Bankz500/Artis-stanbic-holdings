import"./modulepreload-polyfill-B5Qt9EMX.js";import{initializeApp as A}from"https://www.gstatic.com/firebasejs/9.1.3/firebase-app.js";import{getAuth as M,onAuthStateChanged as U,signOut as N}from"https://www.gstatic.com/firebasejs/9.1.3/firebase-auth.js";import{getFirestore as F,doc as E,getDoc as I,collection as f,query as y,where as w,getDocs as C}from"https://www.gstatic.com/firebasejs/9.1.3/firebase-firestore.js";const H={apiKey:"AIzaSyABYV12B7RM2ZCD2G1lFTLpgJwflJFwEXY",authDomain:"beal-offshore.firebaseapp.com",projectId:"beal-offshore",storageBucket:"beal-offshore.firebasestorage.app",messagingSenderId:"1091834410162",appId:"1:1091834410162:web:56285433b5751e681745ab",measurementId:"G-CT463F3T6J"},B=A(H),g=M(B),m=F(B),b=document.getElementById("balance"),x=document.getElementById("name"),c=document.getElementById("history-container"),d=document.getElementById("pending-container");U(g,async e=>{if(console.log("Current user:",e),e){console.log("User is logged in:",e.uid),console.log("Current user:",e);const a=E(m,"users",e.uid),o=await I(a);if(console.log("User document exists:",o.exists()),o.exists()){console.log("User data:",o.data());const n=o.data(),r=n.wallet||0;b?b.textContent=`$${parseFloat(r).toFixed(2)}`:console.warn("Balance element not found in the DOM"),x&&(x.textContent=n.firstName?`, ${n.firstName}`:", User");const D=f(m,"history"),v=y(D,w("userId","==",e.uid)),h=await C(v);if(c)if(c.innerHTML="",!h.empty)h.forEach(t=>{const i=t.data(),s=document.createElement("div");s.className="bg-white p-4 rounded-lg shadow-md text-center",s.innerHTML=`
                                    <h3 class="font-semibold text-gray-800">${i.description||"No description"}</h3>
                                    <p class="text-gray-600">$${i.amount||""}</p>
                                `,c.appendChild(s)});else{const t=document.createElement("div");t.className="bg-white p-4 rounded-lg shadow-md text-center",t.innerHTML='<h3 class="font-semibold text-gray-800">No history</h3>',c.appendChild(t)}const T=f(m,"pending"),$=y(T,w("userId","==",e.uid)),p=await C($);if(d)if(d.innerHTML="",!p.empty)p.forEach(t=>{const i=t.data(),s=document.createElement("div");s.className="bg-white p-4 rounded-lg shadow-md text-center",s.innerHTML=`
                                    <h3 class="font-semibold text-gray-800">${i.description||"No description"}</h3>
                                    <p class="text-gray-600">$${i.amount||""}</p>
                                `,d.appendChild(s)});else{const t=document.createElement("div");t.className="bg-white p-4 rounded-lg shadow-md text-center",t.innerHTML='<h3 class="font-semibold text-gray-800">No pending transactions</h3>',d.appendChild(t)}}else console.log("No user document found in Firestore."),alert("No user data found.")}else console.log("No user signed in, redirecting to sign-in page."),window.location.href="login.html"});window.signOut=function(){N(g).then(()=>{alert("Signed out successfully!"),window.location.href="login.html"}).catch(e=>{alert("Error signing out: "+e.message)})};g.onAuthStateChanged(async e=>{if(console.log("Current user:",e),e)try{const a=E(m,"users",e.uid),o=await I(a);if(console.log("User document exists:",o.exists()),o.exists()){const n=o.data();console.log("User data:",n);const r=document.getElementById("account-name");r&&(r.textContent=n.firstName&&n.lastName?` ${n.firstName} ${n.lastName}`:"Welcome, User")}else console.error("No user document found!"),document.getElementById("account-name").textContent="Not Available"}catch(a){console.error("Error fetching user data:",a),document.getElementById("account-name").textContent="Error loading name"}else console.error("User not signed in"),document.getElementById("account-name").textContent="Not Available"});let u=0;function l(){u=0}window.onload=function(){setInterval(function(){u++,u>=10&&(N(g),alert("You have been logged out due to inactivity."))},6e4),window.onmousemove=l,window.onkeypress=l,window.onclick=l,window.onscroll=l};
